<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="UTF-8" />
    <title>Canvas experiment</title>
  </head>
  <body>
    <button onclick="dimensions()">Find the natural dimensions</button><br>
    <button onclick="draw()">Show the map on the canvas</button><br>
    <button onclick="getPixel()">Console log the pixel 0,0</button><br>
    <canvas id="canvas" width="160" height="160"></canvas>
    <br>
    <img id="theMap" src="https://registerchilton.github.io/Geography456/UpperCapeFearDEM.jpg" alt="Plan of the Village">
  </body>

<script type="application/javascript">
    var img = document.getElementById("theMap")
    var imageWidth
    var imageHeight

    function draw() {
        const canvas = document.getElementById("canvas");
        const ctx = canvas.getContext("2d");
        ctx.drawImage(img, 0, 0);    
    }

    function dimensions() {
        imageWidth = document.getElementById("theMap").naturalWidth;
        imageHeight = document.getElementById("theMap").naturalHeight;
        document.getElementById("canvas").width = imageWidth
        document.getElementById("canvas").height = imageHeight
        const canvas = document.getElementById("canvas");
        if (canvas.getContext) {
            const ctx = canvas.getContext("2d");
            img.onload = () => {ctx.drawImage(img, 0, 0);}
        }
    }

    function getPixel(){
        const canvas = document.getElementById("canvas");
        const ctx = canvas.getContext("2d", { willReadFrequently: true });
        myImageData = ctx.getImageData(100, 100, 1, 1);
        for (var x = 0; x < imageWidth; x = x + 1) {
          for (var y = 0; y < imageHeight; y = y + 1) {
            myImageData = ctx.getImageData(x, y, 1, 1);
          if (myImageData.data[1] < 150) {
                console.log("value at " + x + ","+ y + "red = " + myImageData.data[0])
                console.log("value at " + x + ","+ y + "blue = " + myImageData.data[1])
                console.log("value at " + x + ","+ y + "green = " + myImageData.data[2])
                console.log("value at " + x + ","+ y + "alpha = " + myImageData.data[3])
            }
            //else{console.log("Not " + x + "," + y)}
          }
        }
      }    
</script>
  </html>
